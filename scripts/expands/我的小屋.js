var zx37 = "#fMap/MapHelper.img/weather/maple/1#";//楓葉
var zx38 = "#fMap/MapHelper.img/weather/maple/2#";//楓葉
var Icon = [
	Array("星星", "#fEtc/ChatEmoticon/expression/1/0#"),
	Array("彩虹", "#fEffect/ItemEff/1102877/effect/default/0#"),
	Array("猫咪", "#fUI/NameTag/190/w#"),
	Array("猫咪", "#fUI/NameTag/190/c#"),
	Array("猫咪", "#fUI/NameTag/190/e#"),
	Array("兔子", "#fEffect/CharacterEff/1112960/0/1#"),
	Array("星空", "#fUI/GuildMark/BackGround/00001013/16#"),
	Array("骷髅", "#fUI/GuildMark/Mark/Etc/00009000/15#"),
	Array("红心", "#fUI/GuildMark/Mark/Etc/00009001/1#"),
	Array("白脸", "#fUI/GuildMark/Mark/Etc/00009002/4#"),
	Array("皇冠", "#fUI/GuildMark/Mark/Etc/00009004/3#"),
	Array("红灯", "#fUI/GuildMark/Mark/Etc/00009020/1#"),
	Array("王冠", "#fUI/GuildMark/Mark/Etc/00009023/11#"),
	Array("水滴", "#fEffect/BasicEff/MainNotice/Gamsper/Notify/4#"),
	Array("红旗", "#fEffect/BasicEff/MainNotice/BlockBuster/Default/3#"),
	Array("红心", "#fEffect/CharacterEff/1112905/0/0#"),
	Array("云朵", "#fEffect/ItemEff/1102877/effect/default/1#"),
	Array("翅膀", "#fEffect/ItemEff/1102874/effect/ladder/0#"),
	Array("箭矢", "#fEffect/ItemEff/1112003/0/2#"),
	Array("黄鸭", "#fEffect/ItemEff/1004122/effect/default/8#"),
	Array("红点", "#fEffect/CharacterEff/1082588/0/0#"), //红点
	Array("蓝点", "#fEffect/CharacterEff/1082588/3/0#"),  //蓝点
	Array("黄星", "#fEffect/CharacterEff/1112924/0/0#"), //黄星
	Array("蓝星", "#fEffect/CharacterEff/1112925/0/0#"), //蓝星
	Array("红星", "#fEffect/CharacterEff/1112926/0/0#"), //红星
	Array("黄星星", "#fUI/UIPVP.img/MiniMapIcon/star#"),  //黄星星
	Array("星星", "#fEtc/ChatEmoticon/expression/1/0#"),
	Array("兔子", "#fEffect/CharacterEff/1112960/0/1#"),
	Array("星空", "#fUI/GuildMark/BackGround/00001013/16#"),
	Array("骷髅", "#fUI/GuildMark/Mark/Etc/00009000/15#"),
	Array("红心", "#fUI/GuildMark/Mark/Etc/00009001/1#"),
	Array("白脸", "#fUI/GuildMark/Mark/Etc/00009002/4#"),
	Array("皇冠", "#fUI/GuildMark/Mark/Etc/00009004/3#"),
	Array("红灯", "#fUI/GuildMark/Mark/Etc/00009020/1#"),
	Array("王冠", "#fUI/GuildMark/Mark/Etc/00009023/11#"),
	Array("水滴", "#fEffect/BasicEff/MainNotice/Gamsper/Notify/4#"),
	Array("红旗", "#fEffect/BasicEff/MainNotice/BlockBuster/Default/3#"),
	Array("红心", "#fEffect/CharacterEff/1112905/0/0#"),
	Array("云朵", "#fEffect/ItemEff/1102877/effect/default/1#"),
	Array("翅膀", "#fEffect/ItemEff/1102874/effect/ladder/0#"),
	Array("箭矢", "#fEffect/ItemEff/1112003/0/2#"),
	Array("黄鸭", "#fEffect/ItemEff/1004122/effect/default/8#"),
	Array("王冠", "#fUI/GuildMark/Mark/Etc/00009023/10#"),
	Array("灯组", "#fUI/GuildMark/Mark/Etc/00009020/2#"),
	Array("灯组", "#fUI/GuildMark/Mark/Etc/00009020/3#"),
	Array("灯组", "#fUI/GuildMark/Mark/Etc/00009020/4#"),
	Array("灯组", "#fUI/GuildMark/Mark/Etc/00009020/5#"),
	Array("灯组", "#fUI/GuildMark/Mark/Etc/00009020/6#"),
	Array("灯组", "#fUI/GuildMark/Mark/Etc/00009020/7#"),
	Array("灯组", "#fUI/GuildMark/Mark/Etc/00009020/8#"),
	Array("灯组", "#fUI/GuildMark/Mark/Etc/00009020/9#"),
	Array("灯组", "#fUI/GuildMark/Mark/Etc/00009020/10#"),
	Array("灯组", "#fUI/GuildMark/Mark/Etc/00009020/11#"),
	Array("灯组", "#fUI/GuildMark/Mark/Etc/00009020/12#"),
	Array("灯组", "#fUI/GuildMark/Mark/Etc/00009020/13#"),
	Array("灯组", "#fUI/GuildMark/Mark/Etc/00009020/14#"),
	Array("灯组", "#fUI/GuildMark/Mark/Etc/00009020/15#"),
	Array("灯组", "#fUI/GuildMark/Mark/Etc/00009020/16#"),
	Array("条件", "#fUI/UIWindow2.img/Quest/quest_info/summary_icon/startcondition#"),
	Array("信封", "#fUI/GuildMark/BackGround/00001003/5#"),
	Array("信封", "#fUI/GuildMark/BackGround/00001003/12#"),
	Array("钻石", "#fUI/NameTag/medal/556/w#"),
	Array("钻石", "#fUI/NameTag/medal/556/c#"),
	Array("钻石", "#fUI/NameTag/medal/556/e#"),
	Array("三角", "#fUI/piggyBarMinigame/crunch/5#"),
	Array("蓝点", "#fUI/piggyBarMinigame/crunch/1#"),
	Array("女神", "#fUI/RunnerGame/RunnerGameUI/Effect/ItemEffect_Protect1/3#"),
	Array("拇指", "#fUI/NameTag/medal/10/w#"),
	Array("拇指", "#fUI/NameTag/medal/10/c#"),
	Array("拇指", "#fUI/NameTag/medal/10/e#"),
	Array("成功", "#fUI/UIWindowJP/inputDirectionBattleTrigger/input/0/dear/7#"),
	Array("失败", "#fUI/UIWindowJP/inputDirectionBattleTrigger/input/0/fail/7#"),
	Array("星星", "#fUI/UIWindowGL/FeedbackSystem/Star#"),
	Array("蓝星", "#fEffect/CharacterEff/1003393/1/0#"),
	Array("花朵", "#fEffect/CharacterEff/1050334/2/0#"),
	Array("蓝星", "#fEffect/CharacterEff/1003393/0/0#"),
	Array("淡星", "#fEffect/CharacterEff/moveRandomSprayEff/eunwol_seal/effect/0/2#"),
	Array("花朵", "#fEffect/CharacterEff/1051294/1/0#"),
	Array("花朵", "#fEffect/CharacterEff/1051296/1/0#"),
	Array("金菇", "#fUI/NameTag/medal/74/w#"),
	Array("金菇", "#fUI/NameTag/medal/74/c#"),
	Array("金菇", "#fUI/NameTag/medal/74/e#"),
	Array("蛋糕", "#fUI/NameTag/medal/758/w#"),
	Array("蛋糕", "#fUI/NameTag/medal/758/c#"),
	Array("蛋糕", "#fUI/NameTag/medal/758/e#"),
	Array("胡子", "#fUI/NameTag/124/w#"),
	Array("胡子", "#fUI/NameTag/124/c#"),
	Array("胡子", "#fUI/NameTag/124/e#"),
	Array("帽子", "#fUI/NameTag/nick/312/w#"),
	Array("帽子", "#fUI/NameTag/nick/312/c#"),
	Array("帽子", "#fUI/NameTag/nick/312/e#"),
	Array("圣诞", "#fUI/NameTag/medal/728/w#"),
	Array("圣诞", "#fUI/NameTag/medal/728/c#"),
	Array("圣诞", "#fUI/NameTag/medal/728/e#"),
	Array("红钻", "#fUI/UIWindowPL/DuoEvent/Maximum/DuoInfo/icon/GoodF/0#"),
	Array("王冠", "#fUI/NameTag/medal/468/w#"),
	Array("王冠", "#fUI/NameTag/medal/468/c#"),
	Array("王冠", "#fUI/NameTag/medal/468/e#"),
	Array("确认", "#fUI/CashShop.img/CSCoupon/BtOK/normal/0#"),
	Array("幽灵", "#fEffect/ItemEff/1004738/effect/ladder/0#"),
	Array("幽灵", "#fEffect/ItemEff/1004738/effect/default/7#"),
	Array("幽灵", "#fEffect/ItemEff/1004738/effect/walk1/3#"),
	Array("幽灵", "#fEffect/ItemEff/1004738/effect/jump/0#"),
	Array("音符", "#fEffect/ItemEff/1112811/0/0#"),
	Array("红心", "#fEffect/CharacterEff/1112905/0/0#"),
	Array("幽灵", "#fEffect/ItemEff/1004738/effect/default/0#"),
	Array("幽灵", "#fEffect/ItemEff/1004738/effect/default/1#"),
	Array("幽灵", "#fEffect/ItemEff/1004738/effect/default/2#"),
	Array("幽灵", "#fEffect/ItemEff/1004738/effect/default/3#"),
	Array("金左指标", "#fUI/UIWindow/MonsterBook/arrowLeft/normal/0#"),
	Array("金右指标", "#fUI/UIWindow/MonsterBook/arrowRight/normal/0#"),
	Array("简单", "#fEffect/ItemEff/1102877/effect/default/0#")
];
let mapA = map.getId();
txt = "";
//txt+= "getMyHomeType:"+player.getMyHomeType()+"\r\n";

txt = "\t" + Icon[17][1] + "#fs20##fc0xFF00caf2##e我的小屋" + Icon[17][1] + "#r#n\r\n";
txt += "" + Icon[43][1] + Icon[44][1] + Icon[45][1] + Icon[46][1] + Icon[47][1] + Icon[48][1] + Icon[49][1] + Icon[50][1]
	+ Icon[51][1] + Icon[52][1] + Icon[53][1] + Icon[54][1] + Icon[55][1] + Icon[56][1] + Icon[57][1] + Icon[43][1] + Icon[44][1]
	+ Icon[45][1] + Icon[46][1] + Icon[47][1] + Icon[48][1] + Icon[49][1] + Icon[50][1] + Icon[51][1] + Icon[52][1] + Icon[53][1]
	+ Icon[54][1] + Icon[55][1] + Icon[56][1] + Icon[57][1] + Icon[47][1] + Icon[44][1] + "\r\n";

//txt+= "#fs20##r\t\t  #e我的小屋\r\n#n#k";
//txt+= ""+zx37+zx38+zx37+zx38+zx37+zx38+zx37+zx38+zx37+zx38+zx37+zx38+zx37+zx38+zx37+zx38+zx37+"\r\n";
txt += "#fs11##b";

txt += "請玩家盡量都以本尊執行小屋相關系統\r\n\r\n";
txt += "";

if (player.getChannel() != 1) {
	txt += "請玩家務必於1S分流使用小屋相關的腳本及物品!\r\n";
} else if (player.getMyHomeType() == 0) {
	if (player.isQuestCompleted(500763)) {
		txt += "#L0#一鍵開通小屋(需消耗50萬楓點)#l\r\n\r\n";
	}
} else {
	txt += "" + Icon[103][1] + "#L1#回去溫暖的家#l\r\n\r\n\r\n";
	if (mapA >= 871100000 && mapA <= 871100050) {

		txt += "" + Icon[103][1] + "#L8#擴充家的欄位[100W楓點/8欄位]#l\r\n\r\n\r\n";
	}
	if (player.getEventValue("安逸的菇菇小屋擴建") < 1) {
		txt += "#r檢測到尚未擴建安逸的菇菇小屋\r\n";
		txt += "" + Icon[103][1] + "#r#L4#購買#v2633483##b(需500萬楓點)#l\r\n\r\n";
		txt += "" + Icon[43][1] + Icon[44][1] + Icon[45][1] + Icon[46][1] + Icon[47][1] + Icon[48][1] + Icon[49][1] + Icon[50][1]
			+ Icon[51][1] + Icon[52][1] + Icon[53][1] + Icon[54][1] + Icon[55][1] + Icon[56][1] + Icon[57][1] + Icon[43][1] + Icon[44][1]
			+ Icon[45][1] + Icon[46][1] + Icon[47][1] + Icon[48][1] + Icon[49][1] + Icon[50][1] + Icon[51][1] + Icon[52][1] + Icon[53][1]
			+ Icon[54][1] + Icon[55][1] + Icon[56][1] + Icon[57][1] + Icon[47][1] + Icon[44][1] + "\r\n";
	}

	if (player.getEventValue("安逸的菇菇小屋擴建") >= 1 && player.getEventValue("精緻的洋房擴建") >= 1 && player.getEventValue("海邊的陽台房屋擴建") >= 1 && player.getEventValue("蓮花池庭園瓦屋擴建") >= 1) {


	} else {
		if (player.getEventValue("安逸的菇菇小屋擴建") >= 1) {
			txt += "#r檢測玩家以興建#d#v2633483##z2633483#\r\n";
			txt += "#r並開通下方尊榮小屋\r\n";
			txt += "#r記得房子要興建完畢才能再次使用設計圖\r\n";
			if (player.getEventValue("精緻的洋房擴建") < 1) {
				txt += "#r#L5#購買#v2633484##b(需500萬楓點)#l\r\n";
			}
			if (player.getEventValue("海邊的陽台房屋擴建") < 1) {
				txt += "#r#L6#購買#v2633485##b(需500萬楓點)#l\r\n";
			}
			if (player.getEventValue("蓮花池庭園瓦屋擴建") < 1) {
				txt += "#r#L7#購買#v2634289##b(需500萬楓點)#l\r\n";
			}
			if (player.getEventValue("萬聖節鬼屋瓦屋擴建") < 1) {
				txt += "#r#L9#購買#v2631049##b(需1000萬楓點)#l\r\n";
			}
		}


	}







	if (player.isGm()) {

		txt += "\r\n\r\n\r\ngm\r\n";
		if (!player.isQuestCompleted(65433)) {
			txt += "#L2#珍妮任務#l\r\n";
		}
		if (!player.isQuestCompleted(64590)) {
			txt += "#L3#小屋任務#l\r\n";
		}
		txt += "#L100#擴建材料#l\r\n";
	}
	txt += "\r\n";
}
let sel = npc.askMenu(txt);
// player.addHomeDrawing()
if (sel == 0) {

	if (player.getCashShopCurrency(2) < 500000) {
		npc.say("#fs14##b玩家楓點不足");
	} else {
		// ui打開
		player.updateQuestRecordEx(500767, "1", "1");
		player.updateQuestRecordEx(500767, "2", "1");
		player.updateQuestRecordEx(500767, "3", "1");
		player.updateQuestRecordEx(500767, "4", "1");
		player.updateQuestRecordEx(500767, "5", "1");
		player.updateQuestRecordEx(500767, "6", "1");
		player.updateQuestRecordEx(500767, "7", "1");
		player.updateQuestRecordEx(500767, "managerXpos", "50");//不確定這是捨
		player.updateQuestRecordEx(500767, "managerYpos", "50");//??
		player.updateWorldShareRecord(500767, player.getQuestRecordEx(500767));


		player.updateQuestRecordEx(501465, "askR", "1");//艾咪 基礎數值寫入腳色上
		player.updateQuestRecordEx(501465, "s1", "5");
		player.updateQuestRecordEx(501465, "s2", "1");
		player.updateQuestRecordEx(501465, "s3", "2");
		player.updateQuestRecordEx(501465, "s4", "1");
		player.updateQuestRecordEx(501465, "s5", "1");
		player.updateQuestRecordEx(501465, "bonusTalk", "0");

		player.updateQuestRecordEx(501466, "askR", "1");//阿爾文 基礎數值寫入腳色上
		player.updateQuestRecordEx(501466, "s1", "3");
		player.updateQuestRecordEx(501466, "s2", "5");
		player.updateQuestRecordEx(501466, "s3", "2");
		player.updateQuestRecordEx(501466, "s4", "0");
		player.updateQuestRecordEx(501466, "s5", "1");
		player.updateQuestRecordEx(501466, "bonusTalk", "0");

		player.updateQuestRecordEx(501467, "askR", "1");//管理人基礎數值寫入腳色上
		player.updateQuestRecordEx(501467, "s1", "2");
		player.updateQuestRecordEx(501467, "s2", "1");
		player.updateQuestRecordEx(501467, "s3", "0");
		player.updateQuestRecordEx(501467, "s4", "5");
		player.updateQuestRecordEx(501467, "s5", "3");
		player.updateQuestRecordEx(501467, "bonusTalk", "0");
		player.updateWorldShareRecord(501465, player.getQuestRecordEx(501465));//更新至帳號紀錄存檔
		player.updateWorldShareRecord(501466, player.getQuestRecordEx(501466));
		player.updateWorldShareRecord(501467, player.getQuestRecordEx(501467));


		for (i = 0; i < 22; i++) {//完成新手任務
			player.completeQuest((64590 + i), 0);
		}

		for (i = 19; i <= 33; i++) {//小屋任務
			player.completeQuest((64600 + i), 0);
		}
		var myDate = new Date();
		var s = myDate.getFullYear() + "/" + appendZero(myDate.getMonth() + 1) + "/" + appendZero(myDate.getDate());
		var sDate = s.substr(2);
		player.updateQuestRecordEx(64612, "housing", "4");
		player.updateQuestRecordEx(64612, "furniture", "2");

		player.completeQuest(500763, 0);
		player.updateWorldShareRecord(500767, player.getQuestRecordEx(500767));
		//房屋信息管理
		player.updateQuestRecordEx(500773, "askR", "0");
		player.updateQuestRecordEx(500773, "managerHide", "1");
		player.updateQuestRecordEx(500773, "bonusTalk", "0");
		//player.updateQuestRecordEx(500773, "s5", "-45");
		player.updateQuestRecordEx(500773, "resetDate", sDate);
		player.updateQuestRecordEx(500773, "affDown", "19/12/31");
		player.updateWorldShareRecord(500773, player.getQuestRecordEx(500773));

		//房屋名稱
		player.updateQuestRecordEx(500763, "name", player.getName());
		player.updateWorldShareRecord(500763, player.getQuestRecordEx(500763));
		player.createMyHome();//創建我的家	
		player.modifyCashShopCurrency(2, -500000);
		npc.broadcastPlayerNotice(38, "玩家" + player.getName() + "消耗50萬楓點開通小屋功能!!");
	}




} else if (sel == 1) {
	player.goMyHome();//回家
} else if (sel == 2) {

	for (i = 33; i <= 45; i++) {//珍妮任務
		player.completeQuest((65400 + i), 0);
	}
	player.updateQuestRecordEx(501024, "man", "1");
	player.updateWorldShareRecord(501024, player.getQuestRecordEx(501024));
	player.completeQuest(65447, 0);

} else if (sel == 3) {


	for (i = 0; i < 22; i++) {//完成新手任務 
		player.completeQuest((64590 + i), 0);
	}
	for (i = 19; i <= 33; i++) {//小屋任務
		player.completeQuest((64600 + i), 0);
	}

} else if (sel == 4) {
	if (player.getCashShopCurrency(2) < 5000000) {
		npc.say("#fs14##b楓點不足");
	} else {
		player.modifyCashShopCurrency(2, -5000000);
		player.gainItem(2633483, 1);
		npc.say("#fs14##b購買成功");
	}
} else if (sel == 5) {
	if (player.getCashShopCurrency(2) < 5000000) {
		npc.say("#fs14##b楓點不足");
	} else {
		player.modifyCashShopCurrency(2, -5000000);
		player.gainItem(2633484, 1);
		npc.say("#fs14##b購買成功");
	}
} else if (sel == 6) {
	if (player.getCashShopCurrency(2) < 5000000) {
		npc.say("#fs14##b楓點不足");
	} else {
		player.modifyCashShopCurrency(2, -5000000);
		player.gainItem(2633485, 1);
		npc.say("#fs14##b購買成功");
	}
} else if (sel == 7) {
	if (player.getCashShopCurrency(2) < 5000000) {
		npc.say("#fs14##b楓點不足");
	} else {
		player.modifyCashShopCurrency(2, -5000000);
		player.gainItem(2634289, 1);
		npc.say("#fs14##b購買成功");
	}
} else if (sel == 8) {
	if (player.getCashShopCurrency(2) < 1000000) {
		npc.say("#fs14##b楓點不足100萬");
	} else {
		player.modifyCashShopCurrency(2, -1000000);
		player.gainMyHomeInventorySlots(+8);
		npc.say("#fs14##b購買成功");
	}
} else if (sel == 9) {
	if (player.getCashShopCurrency(2) < 10000000) {
		npc.say("#fs14##b楓點不足");
	} else {
		player.modifyCashShopCurrency(2, -10000000);
		player.gainItem(2631049, 1);
		npc.say("#fs14##b購買成功");
	}
} else if (sel == 100) {
	for (i = 0; i <= 20; i++) {
		if (player.isQuestStarted(501416 + i)) {
			player.gainItem((4036742 + i), 30);
		}
	}
	for (i = 0; i <= 6; i++) {
		if (player.isQuestStarted(501951 + i)) {
			player.gainItem((4036837 + i), 30);
		}
	}

}



function appendZero(s) {
	return ("00" + s).substr((s + "").length);
}