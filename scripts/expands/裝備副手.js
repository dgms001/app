var jobData = new Array(

    Array("影魂異人", 15500, 1353600),
    Array("影魂異人(2轉)", 15510, 1353601),
    Array("影魂異人(3轉)", 15511, 1353602),
    Array("影魂異人(4轉)", 15512, 1353603, 1353602, 1353601, 1353600),

    Array("圣晶使徒", 15200, 1353500), //伊利恩
    Array("圣晶使徒(2轉)", 15210, 1353501),
    Array("圣晶使徒(3轉)", 15211, 1353502),
    Array("圣晶使徒(4轉)", 15212, 1353503),

    Array("魔鏈影士", 6400, 1353300),
    Array("魔鏈影士(2轉)", 6410, 1353301),
    Array("魔鏈影士(3轉)", 6411, 1353302),
    Array("魔鏈影士(4轉)", 6412, 1353303),

    //Array("飛俠",    400,1342000),
    Array("見習刀客", 430, 1342000),
    Array("雙刀客", 431, 1342048),
    Array("雙刀俠", 432, 1342002),
    Array("血刀", 433, 1342004),
    Array("暗影雙刀", 434, 1342008),

    //Array("海盜（炮手）",    501,1352920),
    Array("火炮手（二轉）", 530, 1352920),
    Array("毀滅炮手（三轉）", 531, 1352921),
    Array("神炮王", 532, 1352922),

    Array("龍的傳人（一轉）", 508, 1352820),
    Array("龍的傳人（二轉）", 570, 1352821),
    Array("龍的傳人（三轉）", 571, 1352822),
    Array("龍的傳人（四轉）", 572, 1352823),

    //Array("戰士", 100, 1352200),
    Array("劍客", 110, 1352200),
    Array("勇士", 111, 1352201),
    Array("英雄", 112, 1352202),

    Array("準騎士", 120, 1352210),
    Array("騎士", 121, 1352211),
    Array("圣騎士", 122, 1352212),

    Array("槍戰士", 130, 1352220),
    Array("龍騎士", 131, 1352221),
    Array("黑騎士", 132, 1352222),

    //Array("魔法師",     200, ),
    Array("火毒法師", 210, 1352230),
    Array("火毒巫師", 211, 1352231),
    Array("火毒魔導士", 212, 1352232),
    Array("冰雷法師", 220, 1352240),
    Array("冰雷巫師", 221, 1352241),
    Array("冰雷魔導士", 222, 1352242),
    Array("牧師", 230, 1352250),
    Array("祭司", 231, 1352251),
    Array("主教", 232, 1352252),

    //Array("弓箭手",300,1462001),
    Array("獵人", 310, 1352260),
    Array("射手", 311, 1352261),
    Array("神射手", 312, 1352262),
    Array("弩弓手", 320, 1352270),
    Array("游俠", 321, 1352271),
    Array("箭神", 322, 1352272),

    Array("刺客", 410, 1352290),
    Array("無影人", 411, 1352291),
    Array("隱士", 412, 1352292),

    Array("俠客", 420, 1352280),
    Array("獨行客", 421, 1352281),
    Array("俠盜", 422, 1352282),

    //Array("海盜",       500, 1482000),
    Array("拳手", 510, 1352900),
    Array("斗士", 511, 1352901),
    Array("沖鋒隊長", 512, 1352902),

    Array("火槍手", 520, 1352910),
    Array("大副", 521, 1352911),
    Array("船長", 522, 1352912),

    /*騎士團聯盟-------------------*/
    //Array("魂騎士（一轉）", 1100),
    Array("魂騎士（二轉）", 1110, 1352970),
    Array("魂騎士（三轉）", 1111, 1352971),
    Array("魂騎士（四轉）", 1112, 1352972),

    //Array("炎術士（一轉）", 1200),
    Array("炎術士（二轉）", 1210, 1352970),
    Array("炎術士（三轉）", 1211, 1352971),
    Array("炎術士（四轉）", 1212, 1352972),

    //Array("風靈使者（一轉）", 1300),
    Array("風靈使者（二轉）", 1310, 1352970),
    Array("風靈使者（三轉）", 1311, 1352971),
    Array("風靈使者（四轉）", 1312, 1352972),

    //Array("夜行者（一轉）", 1400),
    Array("夜行者（二轉）", 1410, 1352970),
    Array("夜行者（三轉）", 1411, 1352971),
    Array("夜行者（四轉）", 1412, 1352972),

    //Array("奇襲者（一轉）", 1500),
    Array("奇襲者（二轉）", 1510, 1352970),
    Array("奇襲者（三轉）", 1511, 1352971),
    Array("奇襲者（四轉）", 1512, 1352972),
    /*騎士團聯盟-------------------*/

    //Array("戰神（一轉）", 2100),
    Array("戰神（二轉）", 2110, 1352930),
    Array("戰神（三轉）", 2111, 1352931),
    Array("戰神（四轉）", 2112, 1352932),

    Array("雙弩精靈（一轉）", 2300, 1352000),
    Array("雙弩精靈（二轉）", 2310, 1352001),
    Array("雙弩精靈（三轉）", 2311, 1352002),
    Array("雙弩精靈（四轉）", 2312, 1352003),

    Array("幻影（一轉）", 2400, 1352100),
    Array("幻影（二轉）", 2410, 1352101),
    Array("幻影（三轉）", 2411, 1352102),
    Array("幻影（四轉）", 2412, 1352103),

    Array("夜光法師（一轉）", 2700, 1352400),
    Array("夜光法師（二轉）", 2710, 1352401),
    Array("夜光法師（三轉）", 2711, 1352402),
    Array("夜光法師（四轉）", 2712, 1352403),

    /*惡魔聯盟--------------------------*/
    Array("惡魔獵手（一轉）", 3100, 1099001),
    Array("惡魔獵手（二轉）", 3110, 1099002),
    Array("惡魔獵手（三轉）", 3111, 1099003),
    Array("惡魔獵手（四轉）", 3112, 1099004),
    Array("惡魔復仇者（一轉）", 3101, 1099001),
    Array("惡魔復仇者（二轉）", 3120, 1099002),
    Array("惡魔復仇者（三轉）", 3121, 1099003),
    Array("惡魔復仇者（四轉）", 3122, 1099004),
    /*惡魔聯盟--------------------------*/

    /*反抗者聯盟--------------------------*/
    //Array("豹弩游俠（一轉）", 3300),
    Array("豹弩游俠（二轉）", 3310, 1352960),
    Array("豹弩游俠（三轉）", 3311, 1352961),
    Array("豹弩游俠（四轉）", 3312, 1352962),

    //Array("喚靈斗師（一轉）", 3200),
    Array("喚靈斗師（二轉）", 3210, 1352950),
    Array("喚靈斗師（三轉）", 3211, 1352951),
    Array("喚靈斗師（四轉）", 3212, 1352952),

    Array("機械師（一轉）", 3500, 1352700),
    Array("機械師（二轉）", 3510, 1352701),
    Array("機械師（三轉）", 3511, 1352702),
    Array("機械師（四轉）", 3512, 1352703),

    Array("爆破手（一轉）", 3700, 1353400),
    Array("爆破手（二轉）", 3710, 1353401),
    Array("爆破手（三轉）", 3711, 1353402),
    Array("爆破手（四轉）", 3712, 1353403),
    /*反抗者聯盟--------------------------*/

    /*尖兵聯盟--------------------------*/
    Array("尖兵（一轉）", 3600, 1353001, 1353000, 1353004),
    Array("尖兵（二轉）", 3610, 1353001, 1353000, 1353004),
    Array("尖兵（三轉）", 3611, 1353001, 1353000, 1353004),
    Array("尖兵（四轉）", 3612, 1353001, 1353000, 1353004),
    /*尖兵聯盟--------------------------*/

    /*米哈爾聯盟--------------------------*/
    Array("米哈爾（一轉）", 5100, 1098000),
    Array("米哈爾（二轉）", 5110, 1098001),
    Array("米哈爾（三轉）", 5111, 1098002),
    Array("米哈爾（四轉）", 5112, 1098003),
    /*米哈爾聯盟--------------------------*/

    Array("狂龍戰士（一轉）", 6100, 1352500, 1352501, 1352502, 1352503),
    Array("狂龍戰士（二轉）", 6110, 1352500, 1352501, 1352502, 1352503),
    Array("狂龍戰士（三轉）", 6111, 1352500, 1352501, 1352502, 1352503),
    Array("狂龍戰士（四轉）", 6112, 1352500, 1352501, 1352502, 1352503),

    Array("爆莉萌天使（一轉）", 6500, 1352600, 1352601, 1352602, 1352603, 1352604),
    Array("爆莉萌天使（二轉）", 6510, 1352600, 1352601, 1352602, 1352603, 1352604),
    Array("爆莉萌天使（三轉）", 6511, 1352600, 1352601, 1352602, 1352603, 1352604),
    Array("爆莉萌天使（四轉）", 6512, 1352600, 1352601, 1352602, 1352603, 1352604),

    Array("隱月（一轉）", 2500, 1353100),
    Array("隱月（二轉）", 2510, 1353101),
    Array("隱月（三轉）", 2511, 1353102),
    Array("隱月（四轉）", 2512, 1353103),

    Array("劍豪（一轉）", 4100, 1352800),
    Array("劍豪（二轉）", 4110, 1352801),
    Array("劍豪（三轉）", 4111, 1352802),
    Array("劍豪（四轉）", 4112, 1352803),

    Array("陰陽師（一轉）", 4200, 1552000),
    Array("陰陽師（二轉）", 4210, 1552002),
    Array("陰陽師（三轉）", 4211, 1552005),
    Array("陰陽師（四轉）", 4212, 1552009),

    Array("超能力者（一轉）", 14200, 1353200),
    Array("超能力者（二轉）", 14210, 1353201),
    Array("超能力者（三轉）", 14211, 1353202),
    Array("超能力者（四轉）", 14212, 1353203),

    Array("龍神（一轉）", 2210, 1352940),
    Array("龍神（二轉）", 2212, 1352941),
    Array("龍神（三轉）", 2216, 1352942),
    Array("龍神（四轉）", 2217, 1352943),

    Array("林之林", 11212, 1352813),

    Array("神之子", 10112, 1562000),
	    Array("神之子", 10112, 1562007)

    //Array("新手",0)
);

var a30 = "#fEffect/CharacterEff/1022223/6/0#" //跑马灯
var a31 = "#fEffect/CharacterEff/1022223/7/0#" //跑马灯
var a32 = "#fEffect/CharacterEff/1022223/8/0#" //跑马灯
var a38 = "#fItem/Pet/5000213.img/stand0/0#";//藍色惡魔
var f2 = "#fUI/CashShop/CSBeauty/hairColor/Enable/2#"
var f3 = "#fUI/CashShop/CSBeauty/hairColor/Enable/3#"
var f4 = "#fUI/CashShop/CSBeauty/hairColor/Enable/4#"
var f5 = "#fUI/CashShop/CSBeauty/hairColor/Enable/5#"


str = "#fs16##b";
str += "#r如果出現無法更換副手,可以使用此功能強制更換！\r\n"
str += "#r如果使用強制更換功能,請先卸下你的副手！\r\n"
str += "#r卸下副手的功能取下副手,取下後副手位置會被木盾取代\r\n"
str += "#r需要強制裝的副手,請放到第一格！\r\n"
str += "#r強制裝副手不會管職業,請自己認清自己該帶什麼！\r\n"
str += "#r請將副手放在裝備欄位第一格！\r\n"

str += "       #L0##b裝上副手#l\t"
str += "#L1#卸下副手#l\r\n\r\n"

let selected = npc.askMenuA(str, true);
if (selected == 0) {
    //強制裝副手
    let toDrop = player.getInventorySlot(1, 1);

    if (toDrop == null) {
        npc.say("請將副手放到第一格");
    } else {
        var flag = false;
        var index = -1;
        for (var j = 0; j < jobData.length; j++) {
            if (player.getJob() == jobData[j][1]) {
                index = j;
                for (var k = 2; k < jobData[j].length; k++) {
                    if (toDrop.getDataId() == jobData[j][k]) {
                        flag = true;
                    }
                }
            }
        }
        //var type = Math.floor(toDrop.getDataId() / 10000);
        //if(type == 135 || type == 109){
        if (flag) {
            //副手欄必須是木盾或者是空 才可以使用
            let toDrop2 = player.getInventorySlot(-1, -10);
            if (toDrop2 == null || toDrop2.getDataId() == 1092003) {
                player.equip(-10, toDrop.getDataId());
                toDrop2 = player.getInventorySlot(-1, -10);
                toDrop2.setStr(toDrop.getStr()); //裝備力量
                toDrop2.setDex(toDrop.getDex()); //裝備敏捷
                toDrop2.setInt(toDrop.getInt()); //裝備智力
                toDrop2.setLuk(toDrop.getLuk()); //裝備運氣

                toDrop2.setMad(toDrop.getMad()); //魔法力
                toDrop2.setPad(toDrop.getPad()); //攻擊力

                toDrop2.setStatR(toDrop.getStatR()); // 所有屬性
                toDrop2.setTitle(toDrop.getTitle()); // 道具名
                toDrop2.setBossDamageR(toDrop.getBossDamageR()); // BOSS傷
                toDrop2.setIgnorePDR(toDrop.getIgnorePDR()); // 無視防御
                toDrop2.setDamR(toDrop.getDamR()); // 总伤
                toDrop2.setAttribute(toDrop.getAttribute()); //鎖定狀態
                toDrop2.setRUC(toDrop.getRUC()); //以敲捲數
                toDrop2.setCUC(toDrop.getCUC()); //卷軸已用
                toDrop2.setIUC(toDrop.getIUC()); //黃金槌子
                toDrop2.setIUC2(toDrop.getIUC2()); //白金槌子
                toDrop2.setGrade(toDrop.getGrade())
                toDrop2.setOption(1, toDrop.getOption(1, false), false);
                toDrop2.setOption(2, toDrop.getOption(2, false), false);
                toDrop2.setOption(3, toDrop.getOption(3, false), false);
                toDrop2.setOption(1, toDrop.getOption(1, true), true);
                toDrop2.setOption(2, toDrop.getOption(2, true), true);
                toDrop2.setOption(3, toDrop.getOption(3, true), true);

                toDrop2.setDurability(toDrop.getDurability());

                player.updateItem(-10, toDrop2);

                player.loseInvSlot(1, 1);
                npc.say("強制裝上副手成功！");
            } else {
                var txt = "";
                for (var k = 2; k < jobData[index].length; k++) {
                    txt += "#v" + jobData[index][k] + "#";
                }

                npc.say("您只能裝備此列副手：" + txt);
            }
        } else {
            var txt = "";
            for (var k = 2; k < jobData[index].length; k++) {
                txt += "#v" + jobData[index][k] + "#";
            }

            npc.say("您只能裝備此列副手：" + txt);
        }
    }
} else {
    //卸下副手
    if (player.getFreeSlots(1) < 1) {
        npc.say("請清理裝備欄，留出一格空位");
    } else {
        let toDrop = player.getInventorySlot(-1, -10);
        if (toDrop == null || toDrop.getDataId() == 1092003) {
            npc.say("你沒有佩戴副手，或者使用了本系統沒有切換角色！或者身上被替換成了#v1092003#");
        } else {
            //player.loseInvSlot(-1,-10);
            //player.updateItem(-10, toDrop);

            player.equip(-10, 1092003);

            //制作裝備
            let newItem = player.makeItemWithId(toDrop.getDataId());
            newItem.setStr(toDrop.getStr()); //裝備力量
            newItem.setDex(toDrop.getDex()); //裝備敏捷
            newItem.setInt(toDrop.getInt()); //裝備智力
            newItem.setLuk(toDrop.getLuk()); //裝備運氣

            newItem.setMad(toDrop.getMad()); //魔法力
            newItem.setPad(toDrop.getPad()); //攻擊力

            newItem.setStatR(toDrop.getStatR()); // 所有屬性
            newItem.setTitle(toDrop.getTitle()); // 道具名
            //newItem.setBossDamageR(toDrop.getBossDamageR());// BOSS傷
            //newItem.setIgnorePDR(toDrop.getIgnorePDR());// 無視防御
            newItem.setBossDamageR(toDrop.getBossDamageR()); // BOSS傷
            newItem.setIgnorePDR(toDrop.getIgnorePDR()); // 無視防御
            newItem.setDamR(toDrop.getDamR()); // 总伤
            newItem.setAttribute(toDrop.getAttribute()); //鎖定狀態
            newItem.setRUC(toDrop.getRUC()); //以敲捲數
            newItem.setCUC(toDrop.getCUC()); //卷軸已用
            newItem.setIUC(toDrop.getIUC()); //黃金槌子
            newItem.setIUC2(toDrop.getIUC2()); //白金槌子

            newItem.setGrade(toDrop.getGrade())
            newItem.setOption(1, toDrop.getOption(1, false), false);
            newItem.setOption(2, toDrop.getOption(2, false), false);
            newItem.setOption(3, toDrop.getOption(3, false), false);
            newItem.setOption(1, toDrop.getOption(1, true), true);
            newItem.setOption(2, toDrop.getOption(2, true), true);
            newItem.setOption(3, toDrop.getOption(3, true), true);
            newItem.setDurability(toDrop.getDurability());
            player.gainItem(newItem);

            npc.say("卸載成功");
        }
    }
}

//獲取裝備類型
function getItemType(itemid) {
    var type = Math.floor(itemid / 10000);
    switch (type) {
        case 100:
            return 0; //帽子
        case 104:
            return 1; //上衣
        case 105:
            return 2; //套裝
        case 106:
            return 3; //褲裙
        case 107:
            return 4; //鞋子
        case 108:
            return 5; //手套
        case 110:
            return 6; //披風
        case 115:
            return 13; //護肩
        case 111:
            return 9; //ring
        case 112:
            return 10; //戒指
        case 113:
            return 11; //腰帶
        case 103:
            return 12; //耳環
        case 101:
            return 14;
        case 102:
            return 16;

        default:
            if (type == 120)
                return -1; //圖騰
            if (type == 119)
                return -1; //徽章
            if (type == 135)
                return -1; //副手
            if (type == 171)
                return -1; //神秘
            if (type == 116)
                return -1; //口袋
            if (type == 114)
                return -1; //稱號
            if (type == 167)
                return -1; //心臟
            var type = Math.floor(type / 10);
            if (type == 12 || type == 13 || type == 14 || type == 15 || type == 17) {
                return 7; //武器
            }
            return -1;
    }
}
