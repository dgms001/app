var Icon = [
    Array("星星", "#fEtc/ChatEmoticon/expression/1/0#"),
    Array("彩虹", "#fEffect/ItemEff/1102877/effect/default/0#"),
    Array("猫咪", "#fUI/NameTag/190/w#"),
    Array("猫咪", "#fUI/NameTag/190/c#"),
    Array("猫咪", "#fUI/NameTag/190/e#"),
    Array("兔子", "#fEffect/CharacterEff/1112960/0/1#"),
    Array("星空", "#fUI/GuildMark/BackGround/00001013/16#"),
    Array("骷髅", "#fUI/GuildMark/Mark/Etc/00009000/15#"),
    Array("红心", "#fUI/GuildMark/Mark/Etc/00009001/1#"),
    Array("白脸", "#fUI/GuildMark/Mark/Etc/00009002/4#"),
    Array("皇冠", "#fUI/GuildMark/Mark/Etc/00009004/3#"),
    Array("红灯", "#fUI/GuildMark/Mark/Etc/00009020/1#"),
    Array("王冠", "#fUI/GuildMark/Mark/Etc/00009023/11#"),
    Array("水滴", "#fEffect/BasicEff/MainNotice/Gamsper/Notify/4#"),
    Array("红旗", "#fEffect/BasicEff/MainNotice/BlockBuster/Default/3#"),
    Array("红心", "#fEffect/CharacterEff/1112905/0/0#"),
    Array("云朵", "#fEffect/ItemEff/1102877/effect/default/1#"),
    Array("翅膀", "#fEffect/ItemEff/1102874/effect/ladder/0#"),
    Array("箭矢", "#fEffect/ItemEff/1112003/0/2#"),
    Array("黄鸭", "#fEffect/ItemEff/1004122/effect/default/8#"),
    Array("红点", "#fEffect/CharacterEff/1082588/0/0#"), //红点
    Array("蓝点", "#fEffect/CharacterEff/1082588/3/0#"),  //蓝点
    Array("黄星", "#fEffect/CharacterEff/1112924/0/0#"), //黄星
    Array("蓝星", "#fEffect/CharacterEff/1112925/0/0#"), //蓝星
    Array("红星", "#fEffect/CharacterEff/1112926/0/0#"), //红星
    Array("黄星星", "#fUI/UIPVP.img/MiniMapIcon/star#"),  //黄星星
    Array("星星", "#fEtc/ChatEmoticon/expression/1/0#"),
    Array("兔子", "#fEffect/CharacterEff/1112960/0/1#"),
    Array("星空", "#fUI/GuildMark/BackGround/00001013/16#"),
    Array("骷髅", "#fUI/GuildMark/Mark/Etc/00009000/15#"),
    Array("红心", "#fUI/GuildMark/Mark/Etc/00009001/1#"),
    Array("白脸", "#fUI/GuildMark/Mark/Etc/00009002/4#"),
    Array("皇冠", "#fUI/GuildMark/Mark/Etc/00009004/3#"),
    Array("红灯", "#fUI/GuildMark/Mark/Etc/00009020/1#"),
    Array("王冠", "#fUI/GuildMark/Mark/Etc/00009023/11#"),
    Array("水滴", "#fEffect/BasicEff/MainNotice/Gamsper/Notify/4#"),
    Array("红旗", "#fEffect/BasicEff/MainNotice/BlockBuster/Default/3#"),
    Array("红心", "#fEffect/CharacterEff/1112905/0/0#"),
    Array("云朵", "#fEffect/ItemEff/1102877/effect/default/1#"),
    Array("翅膀", "#fEffect/ItemEff/1102874/effect/ladder/0#"),
    Array("箭矢", "#fEffect/ItemEff/1112003/0/2#"),
    Array("黄鸭", "#fEffect/ItemEff/1004122/effect/default/8#"),
    Array("王冠", "#fUI/GuildMark/Mark/Etc/00009023/10#"),
    Array("灯组", "#fUI/GuildMark/Mark/Etc/00009020/2#"),
    Array("灯组", "#fUI/GuildMark/Mark/Etc/00009020/3#"),
    Array("灯组", "#fUI/GuildMark/Mark/Etc/00009020/4#"),
    Array("灯组", "#fUI/GuildMark/Mark/Etc/00009020/5#"),
    Array("灯组", "#fUI/GuildMark/Mark/Etc/00009020/6#"),
    Array("灯组", "#fUI/GuildMark/Mark/Etc/00009020/7#"),
    Array("灯组", "#fUI/GuildMark/Mark/Etc/00009020/8#"),
    Array("灯组", "#fUI/GuildMark/Mark/Etc/00009020/9#"),
    Array("灯组", "#fUI/GuildMark/Mark/Etc/00009020/10#"),
    Array("灯组", "#fUI/GuildMark/Mark/Etc/00009020/11#"),
    Array("灯组", "#fUI/GuildMark/Mark/Etc/00009020/12#"),
    Array("灯组", "#fUI/GuildMark/Mark/Etc/00009020/13#"),
    Array("灯组", "#fUI/GuildMark/Mark/Etc/00009020/14#"),
    Array("灯组", "#fUI/GuildMark/Mark/Etc/00009020/15#"),
    Array("灯组", "#fUI/GuildMark/Mark/Etc/00009020/16#"),
    Array("条件", "#fUI/UIWindow2.img/Quest/quest_info/summary_icon/startcondition#"),
    Array("信封", "#fUI/GuildMark/BackGround/00001003/5#"),
    Array("信封", "#fUI/GuildMark/BackGround/00001003/12#"),
    Array("钻石", "#fUI/NameTag/medal/556/w#"),
    Array("钻石", "#fUI/NameTag/medal/556/c#"),
    Array("钻石", "#fUI/NameTag/medal/556/e#"),
    Array("三角", "#fUI/piggyBarMinigame/crunch/5#"),
    Array("蓝点", "#fUI/piggyBarMinigame/crunch/1#"),
    Array("女神", "#fUI/RunnerGame/RunnerGameUI/Effect/ItemEffect_Protect1/3#"),
    Array("拇指", "#fUI/NameTag/medal/10/w#"),
    Array("拇指", "#fUI/NameTag/medal/10/c#"),
    Array("拇指", "#fUI/NameTag/medal/10/e#"),
    Array("成功", "#fUI/UIWindowJP/inputDirectionBattleTrigger/input/0/dear/7#"),
    Array("失败", "#fUI/UIWindowJP/inputDirectionBattleTrigger/input/0/fail/7#"),
    Array("星星", "#fUI/UIWindowGL/FeedbackSystem/Star#"),
    Array("蓝星", "#fEffect/CharacterEff/1003393/1/0#"),
    Array("花朵", "#fEffect/CharacterEff/1050334/2/0#"),
    Array("蓝星", "#fEffect/CharacterEff/1003393/0/0#"),
    Array("淡星", "#fEffect/CharacterEff/moveRandomSprayEff/eunwol_seal/effect/0/2#"),
    Array("花朵", "#fEffect/CharacterEff/1051294/1/0#"),
    Array("花朵", "#fEffect/CharacterEff/1051296/1/0#"),
    Array("金菇", "#fUI/NameTag/medal/74/w#"),
    Array("金菇", "#fUI/NameTag/medal/74/c#"),
    Array("金菇", "#fUI/NameTag/medal/74/e#"),
    Array("蛋糕", "#fUI/NameTag/medal/758/w#"),
    Array("蛋糕", "#fUI/NameTag/medal/758/c#"),
    Array("蛋糕", "#fUI/NameTag/medal/758/e#"),
    Array("胡子", "#fUI/NameTag/124/w#"),
    Array("胡子", "#fUI/NameTag/124/c#"),
    Array("胡子", "#fUI/NameTag/124/e#"),
    Array("帽子", "#fUI/NameTag/nick/312/w#"),
    Array("帽子", "#fUI/NameTag/nick/312/c#"),
    Array("帽子", "#fUI/NameTag/nick/312/e#"),
    Array("圣诞", "#fUI/NameTag/medal/728/w#"),
    Array("圣诞", "#fUI/NameTag/medal/728/c#"),
    Array("圣诞", "#fUI/NameTag/medal/728/e#"),
    Array("红钻", "#fUI/UIWindowPL/DuoEvent/Maximum/DuoInfo/icon/GoodF/0#"),
    Array("王冠", "#fUI/NameTag/medal/468/w#"),
    Array("王冠", "#fUI/NameTag/medal/468/c#"),
    Array("王冠", "#fUI/NameTag/medal/468/e#"),
    Array("确认", "#fUI/CashShop.img/CSCoupon/BtOK/normal/0#"),
    Array("幽灵", "#fEffect/ItemEff/1004738/effect/ladder/0#"),
    Array("幽灵", "#fEffect/ItemEff/1004738/effect/default/7#"),
    Array("幽灵", "#fEffect/ItemEff/1004738/effect/walk1/3#"),
    Array("幽灵", "#fEffect/ItemEff/1004738/effect/jump/0#"),
    Array("音符", "#fEffect/ItemEff/1112811/0/0#"),
    Array("红心", "#fEffect/CharacterEff/1112905/0/0#"),
    Array("幽灵", "#fEffect/ItemEff/1004738/effect/default/0#"),
    Array("幽灵", "#fEffect/ItemEff/1004738/effect/default/1#"),
    Array("幽灵", "#fEffect/ItemEff/1004738/effect/default/2#"),
    Array("幽灵", "#fEffect/ItemEff/1004738/effect/default/3#"),
    Array("金左指标", "#fUI/UIWindow/MonsterBook/arrowLeft/normal/0#"),
    Array("金右指标", "#fUI/UIWindow/MonsterBook/arrowRight/normal/0#"),
    Array("简单", "#fEffect/ItemEff/1102877/effect/default/0#")

];
var familiarsArray = Array(

    Array(9970001, 2870001, 100101),
    Array(9970002, 2870002, 120100),
    Array(9970003, 2870003, 130100),
    Array(9970004, 2870004, 130101),
    Array(9970005, 2870005, 150000),
    Array(9970006, 2870006, 150001),
    Array(9970007, 2870007, 150002),
    Array(9970008, 2870008, 210100),
    Array(9970009, 2870009, 1110100),
    Array(9970010, 2870010, 1110101),
    Array(9970011, 2870011, 1110130),
    Array(9970012, 2870012, 1120100),
    Array(9970013, 2870013, 1130100),
    Array(9970014, 2870014, 1140100),
    Array(9970015, 2870015, 1140130),
    Array(9970016, 2870016, 1150000),
    Array(9970017, 2870017, 1150001),
    Array(9970018, 2870018, 1150002),
    Array(9970019, 2870019, 1210100),
    Array(9970021, 2870021, 1210102),
    Array(9970022, 2870022, 1210103),
    Array(9970023, 2870023, 1210104),
    Array(9970025, 2870034, 2110200),
    Array(9970026, 2870035, 2110301),
    Array(9970027, 2870036, 2130100),
    Array(9970028, 2870037, 2130103),
    Array(9970029, 2870038, 2150000),
    Array(9970030, 2870039, 2150001),
    Array(9970031, 2870040, 2150002),
    Array(9970032, 2870041, 2150003),
    Array(9970034, 2870043, 2220100),
    Array(9970035, 2870044, 2220110),
    Array(9970036, 2870045, 2230100),
    Array(9970037, 2870046, 2230101),
    Array(9970038, 2870047, 2230102),
    Array(9970039, 2870048, 2230105),
    Array(9970040, 2870049, 2230106),
    Array(9970041, 2870050, 2230107),
    Array(9970042, 2870051, 2230108),
    Array(9970043, 2870052, 2230109),
    Array(9970044, 2870053, 2230110),
    Array(9970045, 2870054, 2230111),
    Array(9970046, 2870055, 2230112),
    Array(9970047, 2870056, 2230113),
    Array(9970048, 2870057, 2230114),
    Array(9970049, 2870058, 2230131),
    Array(9970050, 2870059, 2230200),
    Array(9970051, 2870060, 2300100),
    Array(9970052, 2870079, 3210200),
    Array(9970053, 2870080, 3210201),
    Array(9970054, 2870081, 3210202),
    Array(9970055, 2870108, 3300000),
    Array(9970056, 2870109, 3300001),
    Array(9970057, 2870110, 3300002),
    Array(9970058, 2870111, 3300003),
    Array(9970059, 2870112, 3300004),
    Array(9970063, 2870117, 9410005),
    Array(9970064, 2870118, 9410006),
    Array(9970065, 2870119, 9410007),
    Array(9970066, 2870120, 3400003),
    Array(9970067, 2870121, 3400005),
    Array(9970068, 2870122, 3400007),
    Array(9970069, 2870123, 3400008),
    Array(9970070, 2870124, 4110300),
    Array(9970071, 2870125, 4110301),
    Array(9970072, 2870126, 4110302),
    Array(9970073, 2870127, 4130100),
    Array(9970074, 2870134, 4230103),
    Array(9970075, 2870220, 1210102),
    Array(9970076, 2870241, 6130203),
    Array(9970077, 2870242, 6130204),
    Array(9970078, 2870244, 6130208),
    Array(9970079, 2870249, 6230100),
    Array(9970080, 2870256, 6230600),
    Array(9970081, 2870257, 6230601),
    Array(9970082, 2870274, 7130002),
    Array(9970083, 2870275, 7130003),
    Array(9970084, 2870279, 7130100),
    Array(9970085, 2870280, 7130101),
    Array(9970086, 2870283, 7130104),
    Array(9970087, 2870289, 7130500),
    Array(9970088, 2870290, 7130501),
    Array(9970089, 2870316, 8140101),
    Array(9970090, 2870317, 8140102),
    Array(9970091, 2870318, 8140103),
    Array(9970092, 2870319, 8140110),
    Array(9970093, 2870320, 8140111),
    Array(9970094, 2870323, 8140500),
    Array(9970095, 2870324, 8140600),
    Array(9970096, 2870325, 8140700),
    Array(9970097, 2870326, 8140701),
    Array(9970113, 2870459, 8610000),
    Array(9970114, 2870460, 8610001),
    Array(9970115, 2870461, 8610002),
    Array(9970116, 2870462, 8610003),
    Array(9970117, 2870463, 8610004),
    Array(9970132, 2871000, 9400000),
    Array(9970133, 2871001, 9400001),
    Array(9970134, 2871002, 9400002),
    Array(9970135, 2871003, 9400003),
    Array(9970136, 2871004, 9400004),
    Array(9970137, 2871011, 8880000),
    Array(9970139, 2872019, 9500193),
    Array(9970140, 2872022, 9500300),
    Array(9970141, 2872023, 9500301),
    Array(9970142, 2872020, 9500195),
    Array(9970143, 2872021, 9500196),
    Array(9970144, 2872018, 9500191),
    Array(9970145, 2872017, 9500190),
    Array(9970146, 2870791, 8630000),
    Array(9970147, 2870792, 8630001),
    Array(9970148, 2870793, 8630002),
    Array(9970149, 2870794, 8630003),
    Array(9970150, 2870795, 8630004),
    Array(9970151, 2870796, 8630005),
    Array(9970152, 2870797, 8630006),
    Array(9970153, 2870798, 8630007),
    Array(9970154, 2870799, 8630008),
    Array(9970155, 2870800, 8630009),
    Array(9970156, 2870801, 8630010),
    Array(9970157, 2870802, 8630011),
    Array(9970158, 2870803, 8630012),
    Array(9970159, 2870805, 8630013),
    Array(9970160, 2870804, 8630014),
    Array(9970161, 2870664, 8641000),
    Array(9970162, 2870672, 8641001),
    Array(9970163, 2870673, 8641005),
    Array(9970164, 2870689, 8641007),
    Array(9970165, 2870690, 8642002),
    Array(9970166, 2870691, 8642006),
    Array(9970167, 2870692, 8642012),
    Array(9970168, 2870693, 8642022),
    Array(9970169, 2870694, 8643000),
    Array(9970170, 2870695, 8643001),
    Array(9970171, 2870696, 8643003),
    Array(9970172, 2870697, 8643011))

var hasList = Array();
let response = npc.askMenu("" + Icon[17][1] + "#fs20##fc0xFF00caf2##e一鍵萌獸" + Icon[17][1] + "#r#n\r\n#fs11#請將你要修改萌獸卡放到萌獸卡空間[其他的請卸下來].\r\n#b請選擇你要升級萌獸卡所在角色。\r\n#r當前角色只能通過其他角色來學習。#b\r\n" + characterList());
var text = "請選擇你要升級的萌獸卡\r\n";
var sel = npc.askMenu(text + familiarsList(response));

var yes = npc.askYesNo("確定嗎?");
if (yes == 1) {
    if (player.getCashShopCurrency(2) > 3000000) {
        player.modifyCashShopCurrency(2, -3000000);
        modifyFamiliars(hasList[sel].id, 5);
        modifyFamiliar(hasList[sel].id, 4);
        player.addEventValue("萌獸一鍵滿級", 1, 30);
        npc.say("修改成功~");
    } else {
        npc.say("楓點不足");
    }
}

function modifyFamiliars(id, familiar) {

    var sql = " update familiars set `level` = ? where id= ? ";
    player.customSqlInsert(sql, familiar, id);
}
function modifyFamiliar(id, familiar) {

    var sql = " update familiars set `stat` = ? where id= ? ";
    player.customSqlInsert(sql, familiar, id);
}

function familiarsList(playerid) {
    var sql = "select id,characters_id,familiar,level,stat from familiars where characters_id = " + playerid + " order by level desc, exp desc limit 10;";
    var resultList = player.customSqlResult(sql);
    var text = "";
    for (var i = 0; i < resultList.size(); i++) {
        var result = resultList.get(i);
        if (result == null) {
            break;
        }
        var famili = {};
        famili.id = result.get("id");
        hasList.push(famili);
        var name;
        if (result.get("stat") == 0) {
            name = "普通";

        } else if (result.get("stat") == 1) {
            name = "特殊";
        } else if (result.get("stat") == 2) {
            name = "稀有";
        } else if (result.get("stat") == 3) {
            name = "罕見";
        } else if (result.get("stat") == 4) {
            name = "傳說";
        }
        text += "#L" + i + "# " + result.get("familiar") + " 等級:" + result.get("level") + "  階級:" + name + "\r\n";
    }
    return text;
}

function characterList() {
    var sql = " select * from characters where accounts_id = ?   ";
    var resultList = player.customSqlResult(sql, player.getAccountId());
    var text = "";
    for (var i = 0; i < resultList.size(); i++) {
        var result = resultList.get(i);
        if (result == null) {
            break;
        }
        if (player.getId() != result.get("id")) {
            text += "#L" + result.get("id") + "# " + result.get("name") + " #l\r\n";
        }

    }
    return text;
}
